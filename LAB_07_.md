1.
--- pkt1
```sql
SELECT * FROM 
CLIENT c
LEFT JOIN `ORDER` o ON c.CLIENT_ID = o.CLIENT_ID
WHERE o.CLIENT_ID IS NULL;
```
lub
```sql
SELECT CLIENT_ID, FULL_NAME FROM 
CLIENT 
WHERE CLIENT_ID NOT IN (select CLIENT_ID From `ORDER`);
```
--- pkt2
```sql
SELECT * FROM 
INVENTORY c
RIGHT JOIN UNIT_OF_MEASUREMENT u on c.UNIT_ID=u.UNIT_ID
Where c.UNIT_ID is null;
```
--- pkt3
```sql
Select p.PRODUCT_NAME, AVG(o.SELL_PRICE-p.PURCHASE_PRICE) as "Sredni zarobek" from 
company_2025.PRODUCT p
JOIN company_2025.ORDER_POSITION o on p.PRODUCT_ID=o.PRODUCT_ID
group by p.PRODUCT_NAME
ORDER BY AVG(o.SELL_PRICE-p.PURCHASE_PRICE) DESC;
```
2.
--- pkt1
```sql
Select distinct(DEPARTMENT_NAME)
FROM EMPLOYEE e
JOIN DEPARTMENT d on e.DEPARTMENT_ID=d.DEPARTMENT_ID
JOIN `ORDER` o on o.EMPLOYEE_ID=e.EMPLOYEE_NAME
WHERE e.EMPLOYEE_NAME IN (select EMPLOYEE_ID FROM `ORDER`);
```
--- pkt2
```sql
Select DEPARTMENT_NAME AS "Nazwa działu",
SUM(s.SELL_PRICE-p.PURCHASE_PRICE) as "Wynik działu"
FROM EMPLOYEE e
JOIN DEPARTMENT d on e.DEPARTMENT_ID=d.DEPARTMENT_ID
JOIN `ORDER` o on o.EMPLOYEE_ID=e.EMPLOYEE_NAME
JOIN company_2025.ORDER_POSITION s on o.ORDER_ID=s.ORDER_ID
JOIN PRODUCT p on p.PRODUCT_ID=s.PRODUCT_ID
GROUP BY DEPARTMENT_NAME;
```
--- pkt3
```sql
Select DEPARTMENT_NAME AS "Nazwa działu",
z.STATUS_NAME,
SUM(s.SELL_PRICE-p.PURCHASE_PRICE) as "Wynik działu"
FROM EMPLOYEE e
JOIN DEPARTMENT d on e.DEPARTMENT_ID=d.DEPARTMENT_ID
JOIN `ORDER` o on o.EMPLOYEE_ID=e.EMPLOYEE_NAME
JOIN company_2025.ORDER_POSITION s on o.ORDER_ID=s.ORDER_ID
JOIN PRODUCT p on p.PRODUCT_ID=s.PRODUCT_ID
JOIN company_2025.ORDER_STATUS z on z.STATUS_ID=o.ORDER_STATUS
GROUP BY DEPARTMENT_NAME, z.STATUS_NAME;
```
3.
--- pkt1
```sql
SELECT CONCAT(PRODUCT_NAME,"(",`DESCRIPTION`,")")AS"Produkt(opis)" FROM PRODUCT;
```
--- pkt2
```sql
SELECT CONCAT_WS(',',PRODUCT_ID, CATEGORY_ID, PRODUCT_NAME, PURCHASE_PRICE,`DESCRIPTION`) FROM PRODUCT;
```
--- pkt3
```sql
SELECT d.DEPARTMENT_NAME, GROUP_CONCAT(CONCAT(FIRST_NAME,"-",LAST_NAME)) 
FROM EMPLOYEE e
JOIN DEPARTMENT d on d.DEPARTMENT_ID=e.DEPARTMENT_ID
group by d.DEPARTMENT_NAME;
```
--- pkt4
```sql
SELECT CATEGORY_NAME, group_concat(PRODUCT_NAME) 
FROM PRODUCT p
JOIN company_2025.CATEGORY c on p.CATEGORY_ID=c.CATEGORY_ID
GROUP BY p.CATEGORY_ID;
```
4.
--- pkt1
```sql
Select ORDER_ID, IF(ORDER_STATUS in (3,4,5,7,10),"zakończone",'Inny' ) as status
from `ORDER` o;
```
--- pkt2
```sql
SELECT p.PRODUCT_NAME,
CASE when i.AMOUNT = 0 THEN 'brak'
when 0<i.AMOUNT and i.AMOUNT<10 then 'mała ilość'
when 9<i.AMOUNT and i.AMOUNT<31 Then "średnia ilość"
when i.AMOUNT>30 then 'duza ilosc'
else 'błąd w danych'
END AS "dostępność"
FROM PRODUCT p
join INVENTORY i on i.PRODUCT_ID=p.PRODUCT_ID; 
```
--- pkt3
```sql
SELECT ifnull(TAX_IDENTIFIER, 'klient indywidualny')
FROM CLIENT;
```
--- pkt1
```sql
SELECT CITY,
substr(POSTAL_CODE,1,2)
FROM CLIENT_ADDRESS;
```
--- pkt2
```sql
SELECT CITY AS MIASTO,
group_concat(DISTINCT SUBSTR(POSTAL_CODE,1,2)) AS 'UNIKALNE 2 ZNAKI Z KODU' 
FROM CLIENT_ADDRESS
GROUP BY CITY;
```
--- pkt3
```sql
SELECT REGEXP_SUBSTR(substr(STREET,5), '^[^0-9]+')
FROM CLIENT_ADDRESS;
```
LUB
```sql
SELECT substr(STREET,
POSITION(" " in STREET), 
length(STREET)-length(((substr(REVERSE(STREET),1,POSITION(" " in STREET)))))-1)
AS ULICA
FROM CLIENT_ADDRESS;
```
